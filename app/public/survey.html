<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Friend Finder Survey</title>
	
	<!-- jQuery link -->
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

	<!-- Latest compiled and minified CSS -->
 	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">

 	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	
	<style>
	body {
		background-image: url("../../images/587536776.jpg");
		background-repeat: no-repeat;
		background-position: center center;
		background-attachment: fixed;
		background-size: cover;
	}
	.jumbotron {
		background: none;
	}
	#startSurvey {
		margin-top: 18%;
	}

	</style>

</head>
<body>

	<div class="container">
		
		<!-- Button trigger modal -->
		<div class="text-center">
		<button id="startSurvey" type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
		  Launch Survey
		</button>
		</div>

		<!-- Modal -->
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
		  <div class="modal-dialog" role="document">
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
		        <h2 class="modal-title" id="myModalLabel">Let's Find You Some Friends</h2>
		        <h3>About You</h3>
		      </div>
		      <div class="modal-body">
		        <form>
				  <div class="form-group">
				    <label for="name">Name (Required)</label>
				    <input type="text" class="form-control" id="name" placeholder="Name">
				  </div>
				  <div class="form-group">
				    <label for="photo">Link to Photo Image (Required)</label>
				    <input type="url" class="form-control" id="photo" placeholder="Link to Photo">
				  </div>
				  <hr>
					<div class="well">

						<h4>Question 1</h4>
						<p>Your mind is always buzzing with unexplored ideas and plans.</p>
						<select data-placeholder class="chosen-select" id="q1">
							  <option value></option>
							  <option value="1">1 (Strongly Disagree)</option>
							  <option value="2">2</option>
							  <option value="3">3</option>
							  <option value="4">4</option>
							  <option value="5">5 (Strongly Agree)</option>
						</select>
					</div>

					<div class="well">
						<h4>Question 2</h4>
						<p>Your mind is always buzzing with unexplored ideas and plans.</p>
						<select data-placeholder class="chosen-select" id="q2">
							  <option value></option>
							  <option value="1">1 (Strongly Disagree)</option>
							  <option value="2">2</option>
							  <option value="3">3</option>
							  <option value="4">4</option>
							  <option value="5">5 (Strongly Agree)</option>
						</select>
					</div>

					<div class="well">
						<h4>Question 3</h4>
						<p>Your mind is always buzzing with unexplored ideas and plans.</p>
						<select data-placeholder class="chosen-select" id="q3">
							  <option value></option>
							  <option value="1">1 (Strongly Disagree)</option>
							  <option value="2">2</option>
							  <option value="3">3</option>
							  <option value="4">4</option>
							  <option value="5">5 (Strongly Agree)</option>
						</select>
					</div>

					<div class="well">
						<h4>Question 4</h4>
						<p>Your mind is always buzzing with unexplored ideas and plans.</p>
						<select data-placeholder class="chosen-select" id="q4">
							  <option value></option>
							  <option value="1">1 (Strongly Disagree)</option>
							  <option value="2">2</option>
							  <option value="3">3</option>
							  <option value="4">4</option>
							  <option value="5">5 (Strongly Agree)</option>
						</select>
					</div>

					<div class="well">
						<h4>Question 5</h4>
						<p>Your mind is always buzzing with unexplored ideas and plans.</p>
						<select data-placeholder class="chosen-select" id="q5">
							  <option value></option>
							  <option value="1">1 (Strongly Disagree)</option>
							  <option value="2">2</option>
							  <option value="3">3</option>
							  <option value="4">4</option>
							  <option value="5">5 (Strongly Agree)</option>
						</select>
					</div>

					<div class="well">
						<h4>Question 6</h4>
						<p>Your mind is always buzzing with unexplored ideas and plans.</p>
						<select data-placeholder class="chosen-select" id="q6">
							  <option value></option>
							  <option value="1">1 (Strongly Disagree)</option>
							  <option value="2">2</option>
							  <option value="3">3</option>
							  <option value="4">4</option>
							  <option value="5">5 (Strongly Agree)</option>
						</select>
					</div>
									
				  </div>

				  

				 
				</form>
		      </div>
		      <div class="modal-footer">
		        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		        <button type="submit" class="btn btn-primary submit">Find Me Friends</button>
		        <a href="/home"><button type="button" class="btn btn-success"><span class="glyphicon glyphicon-home"></span></button></a>
		      </div>
		    </div>
		  </div>
		</div>



	</div> <!-- closes 'container' -->

<script type="text/javascript">

	jQuery.ajaxSettings.traditional = true;
    
    $(window).on('load',function(){
        $('#myModal').modal('show');
    });

    $(".submit").on("click", function(event) {
      event.preventDefault();

      // Here we grab the form elements
      var newFriend = {
        name: $("#name").val().trim(),
        photo: $("#photo").val().trim(),
        scores: (($("#q1").val().trim()) + "," 
        	+ ($("#q2").val().trim()) + "," 
        	+ ($("#q3").val().trim()) + ","
        	+ ($("#q4").val().trim()) + ","
        	+ ($("#q5").val().trim()) + ","
        	+ ($("#q6").val().trim())).split(",")
      };

      // FOUND ON STACK OVERFLOW AND IT SEEMS TO WORK TO CHANGE STRING TO INTERGER.  
      
      for(var i=0; i<newFriend.scores.length;i++) newFriend.scores[i] = parseInt(newFriend.scores[i], 10);

      // /API/FRIENDS STILL SHOWS AN ARRAY OF STRINGS, NOT INTEGERS. I DON'T UNDERSTAND WHY...


      console.log(newFriend);

	$.post("/api/friends", newFriend,
        function(data) {

          // If a table is available... tell user they are booked.
          if (data) {
            alert("Yay! We've found you a friend, but just one.");
          }

          // If a table is available... tell user they on the waiting list.
          else {
            alert("Sorry you are on the wait list.");
          }

          // Clear the form when submitting
          // $("#reserve-name").val("");
          // $("#reserve-phone").val("");
          // $("#reserve-email").val("");
          // $("#reserve-unique-id").val("");

        });

    });

</script>

</body>
</html>